---
title: Upgrading Cloud Service Broker for GCP
owner: Cloud Service Broker
---

This topic describes how to upgrade <%= vars.product_full %>.

## <a id="upgrade-to-1-1"></a> Upgrading from v1.0 to v1.1

If you have Redis or Dataproc instances created with previous versions of the <%= vars.product_short %>
without explicitly passing a value for `instance_id` for Redis or `name` for Dataproc, you must
update those instances before installing this version.

For Redis instances, set `instance_id` by running:

```console
cf update-service SERVICE-INSTANCE-NAME -c '{"instance_id":"CURRENT-NAME-FROM-GCP-CONSOLE"}'
```

For Dataproc instances, set `name` by running:

```console
cf update-service SERVICE-INSTANCE-NAME -c '{"name":"CURRENT-NAME-FROM-GCP-CONSOLE"}'
```

## <a id="upgrade-to-1-0"></a> Upgrading from beta to v1.0

Because of differences in the PostgreSQL service offering, it is not possible to upgrade beta
instances to v1.0.
You must delete all previously created service instances before upgrading <%= vars.product_short %>
from v0.2 to v1.0.

To retain beta instances in the IaaS, remove them from Cloud Foundry.
<%= vars.product_short %> no longer manages these instances.

To remove the instances from Cloud Foundry, run the command:

```console
cf purge-service-instance
```

## <a id="upgrade-to-1-2"></a> Upgrading to v1.2

### <a id="gcp-changing-custom-plans"></a> Changing custom plans

Make the following changes to existing custom plans before upgrading.

#### <a id="gcp-mysql-set-tier"></a> Set `tier` for the MySQL service

If you have custom plans already configured for MySQL, you must change the configuration.
This is because the old property `cores` was removed, and you have to use `tier` instead to define
compute and memory capacity.

To ensure that no unintended changes happen to your existing instances, add the `tier` property.
For example:

```json
  {
    "name": "my-custom-plan",
    "id": "dd448d6e-1d71-11ed-9974-77a0c9ef0141",
    "description": "Custom plan",
    "tier": "db-n1-standard-2",
    "storage_gb": 10,
    "mysql_version": "MYSQL_5_7"
  }
```

For more information about the machine types, see the
[GCP documentation](https://cloud.google.com/sql/docs/mysql/instance-settings).

## <a id="procedure"></a> Upgrade procedure

To upgrade the <%= vars.product_short %> to a later version:

1. Download the new version of <%= vars.product_short %> from
[<%= vars.product_network %>](https://network.pivotal.io/products/cloud-service-broker-gcp/).

1. Follow the procedure in [Installing with GCP](installing-with-gcp.html).

1. If you are upgrading to a version later than v1.0, service instances might need to be upgraded.
Before installing the new version, see
[Upgrade All Service Instances Config](installing-with-gcp.html#upgrade-all-config).
